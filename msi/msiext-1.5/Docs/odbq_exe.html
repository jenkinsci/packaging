<html>
 <head>
  <link rel="stylesheet" href="maven-theme.css"> 
  <title>AppSecInc. MSI Extensions</title>
 </head>
 <body>
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">AppSecInc. MSI Extensions</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ODBQ Execution Tool </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>ODBQ.exe exposes functionality provided by the <a class="el" href="class_wix_1_1_extensions_1_1_data_source_1_1_o_d_b_c_execute.html">Wix::Extensions::DataSource::ODBCExecute</a> and the <a class="el" href="class_wix_1_1_extensions_1_1_data_source_1_1_o_d_b_c_execute_file.html">Wix::Extensions::DataSource::ODBCExecuteFile</a> MSI extensions to the command line.</p>
<h1><a class="anchor" id="odbq_exe_usage"></a>
Usage:</h1>
<div class="fragment"><div class="line">USAGE:</div>
<div class="line"></div>
<div class="line">   ODBQ.exe  {--sql &lt;string&gt; ... |--file &lt;file&gt; ... |--datafile &lt;datafile&gt; ...}</div>
<div class="line">             [--outputfile &lt;file&gt;] </div>
<div class="line">             [--type &lt;string&gt;|--delimiter &lt;string&gt;]</div>
<div class="line">             [--connectionstring &lt;string&gt;]</div>
<div class="line">             [--database &lt;string&gt;] </div>
<div class="line">             [--flattenonly]</div>
<div class="line">             [--noresults] [--nosql] [--nologo] [--rawoutput]</div>
<div class="line">             [--] [--version] [-h]</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">Where:</div>
<div class="line"></div>
<div class="line">   --sql  (accepted multiple times)</div>
<div class="line">     (OR required)  SQL query to execute, eg. <span class="stringliteral">&quot;SELECT @@VERSION&quot;</span>.</div>
<div class="line">         -- OR --</div>
<div class="line">   --file, -f  (accepted multiple times)</div>
<div class="line">     (OR required)  File(s) containing SQL statements, may be a wildcard.</div>
<div class="line">         -- OR --</div>
<div class="line">   --datafile  (accepted multiple times)</div>
<div class="line">     (OR required)  XML file containing data sets to insert.</div>
<div class="line"></div>
<div class="line">   --outputfile, -o</div>
<div class="line">     Xml output file <span class="keywordflow">for</span> messages and dataset results.</div>
<div class="line"></div>
<div class="line">   --type, -t</div>
<div class="line">     type of emulated command-line tool. May be on of (<span class="keywordflow">case</span>-incensitive):</div>
<div class="line">         SqlServer, MSSQL, osql, sqlcmd, tsql  - <span class="keywordflow">for</span> MS SQL Server</div>
<div class="line">         Oracle, sqlplus, sql*plus - <span class="keywordflow">for</span> Oracle.</div>
<div class="line">     Delimiter <span class="keywordflow">for</span> splitting SQL are selected according to type,</div>
<div class="line">     insert commands are supported.</div>
<div class="line">     Default is SqlServer.</div>
<div class="line">         -- OR --</div>
<div class="line">   --delimiter</div>
<div class="line">     Delimiter <span class="keywordflow">for</span> splitting SQL statements, eg. <span class="stringliteral">&quot;GO&quot;</span>. </div>
<div class="line">     Note: delimiter is <span class="keywordflow">case</span>-nsensitive, recognized only at the beginning of line</div>
<div class="line"></div>
<div class="line">   --connectionstring</div>
<div class="line">     Driver-specific connection <span class="keywordtype">string</span> to use to connect to the server,</div>
<div class="line">     eg. <span class="stringliteral">&quot;Driver=SQL Server;Server=.;Trusted_Connection=yes&quot;</span></div>
<div class="line"></div>
<div class="line">   --database</div>
<div class="line">     Default database name, added to the connection <span class="keywordtype">string</span>.</div>
<div class="line"></div>
<div class="line">   --flattenonly</div>
<div class="line">     Don<span class="stringliteral">&#39;t execute sql, only substitute all included files</span></div>
<div class="line"><span class="stringliteral">     and print resulting flattened sql file either to standard output</span></div>
<div class="line"><span class="stringliteral">     or to the &lt;outputfile&gt; if specified</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">   --noresults</span></div>
<div class="line"><span class="stringliteral">     Suppress results output to console.</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">   --nosql</span></div>
<div class="line"><span class="stringliteral">     Suppress SQL statements output to console.</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">   --nologo</span></div>
<div class="line"><span class="stringliteral">     Suppress logo and messages, raw output only.</span></div>
<div class="line"><span class="stringliteral">     </span></div>
<div class="line"><span class="stringliteral">   --rawoutput</span></div>
<div class="line"><span class="stringliteral">     Output results into file in &#39;</span>raw<span class="stringliteral">&#39; format (rows \n-separated, </span></div>
<div class="line"><span class="stringliteral">     columns \t-separated) rather then in xml format.</span></div>
<div class="line"><span class="stringliteral">     Also switches off output of column headers and row/column counts.</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">   --,  --ignore_rest</span></div>
<div class="line"><span class="stringliteral">     Ignores the rest of the labeled arguments following this flag.</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">   --version</span></div>
<div class="line"><span class="stringliteral">     Displays version information and exits.</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">   -h,  --help</span></div>
<div class="line"><span class="stringliteral">     Displays usage information and exits.</span></div>
</div><!-- fragment --><h1><a class="anchor" id="odbq_exe_examples"></a>
Examples:</h1>
<h2><a class="anchor" id="odbq_exe_examples_localhost_statement"></a>
Executing a statement on a local SQL server.</h2>
<div class="fragment"><div class="line">$ odbq.exe --sql <span class="stringliteral">&quot;PRINT @@VERSION&quot;</span></div>
<div class="line"></div>
<div class="line">ODBQ 1.0.2758.0 - Copyright (c) Application Security Inc.</div>
<div class="line"></div>
<div class="line">- Connecting with &quot;Driver=SQL Server;Server=.;Trusted_Connection=yes;&quot;&quot;</div>
<div class="line">&gt; PRINT @@VERSION</div>
<div class="line">&lt; Microsoft SQL Server 2005 - 9.00.3068.00 (Intel X86)</div>
<div class="line">        Feb 26 2008 18:15:01</div>
<div class="line">        Copyright (c) 1988-2005 Microsoft Corporation</div>
<div class="line">        Standard Edition on Windows NT 5.1 (Build 2600: Service Pack 3)</div>
</div><!-- fragment --><h2><a class="anchor" id="odbq_exe_examples_resultsxml"></a>
Executing a statement and writing results to an xml output file.</h2>
<div class="fragment"><div class="line">$ odbq.exe --sql <span class="stringliteral">&quot;SELECT @@VERSION&quot;</span> --outputfile Version.xml</div>
<div class="line"></div>
<div class="line">ODBQ 1.0.2758.0 - Copyright (c) Application Security Inc.</div>
<div class="line"></div>
<div class="line">- Connecting with &quot;Driver=SQL Server;Server=.;Trusted_Connection=yes;&quot;&quot;</div>
<div class="line">&gt; SELECT @@VERSION</div>
<div class="line">&lt; 1x1</div>
<div class="line">Column1</div>
<div class="line">-------</div>
<div class="line">Microsoft SQL Server 2005 - 9.00.3068.00 (Intel X86)</div>
<div class="line">        Feb 26 2008 18:15:01</div>
<div class="line">        Copyright (c) 1988-2005 Microsoft Corporation</div>
<div class="line">        Standard Edition on Windows NT 5.1 (Build 2600: Service Pack 3)</div>
<div class="line">- Writing &quot;F:\source\commoncomponents\Msi\trunk\target\Debug\bin\Version.xml&quot;</div>
</div><!-- fragment --><p>The resulting version.xml is:</p>
<div class="fragment"><div class="line">&lt;Data&gt;</div>
<div class="line"> &lt;DataSet columns=<span class="stringliteral">&quot;1&quot;</span> rows=<span class="stringliteral">&quot;1&quot;</span>&gt;</div>
<div class="line">  &lt;Query&gt;SELECT @@VERSION&lt;/Query&gt; </div>
<div class="line">  &lt;RowSet&gt;</div>
<div class="line">   &lt;Row&gt;</div>
<div class="line">    &lt;Column1 type=<span class="stringliteral">&quot;nvarchar&quot;</span>&gt;Microsoft SQL Server 2005 - 9.00.3068.00 (Intel X86) Feb 26 2008 18:15:01 Copyright (c) 1988-2005 Microsoft Corporation Developer Edition on Windows NT 6.0 (Build 6001: Service Pack 1)&lt;/Column1&gt; </div>
<div class="line">   &lt;/Row&gt;</div>
<div class="line">  &lt;/RowSet&gt;</div>
<div class="line">  &lt;Messages /&gt; </div>
<div class="line"> &lt;/DataSet&gt;</div>
<div class="line">&lt;/Data&gt;</div>
</div><!-- fragment --><h2><a class="anchor" id="odbq_exe_examples_importxml"></a>
Importing data from xml.</h2>
<p>You can use the files exported from ODBQ.exe with &ndash;outputfile with some modifications: you must add the table name to the RowSet node.</p>
<div class="fragment"><div class="line">&lt;Data&gt;</div>
<div class="line"> &lt;DataSet columns=<span class="stringliteral">&quot;6&quot;</span> rows=<span class="stringliteral">&quot;6&quot;</span>&gt;</div>
<div class="line">  &lt;RowSet table=<span class="stringliteral">&quot;MyDatabase.dbo.SomeTable&quot;</span>&gt;</div>
<div class="line">   &lt;Row&gt;</div>
<div class="line">    &lt;EntryID type=<span class="stringliteral">&quot;integer&quot;</span>&gt;1&lt;/EntryID&gt; </div>
<div class="line">    &lt;Key type=<span class="stringliteral">&quot;nvarchar&quot;</span>&gt;key&lt;/Key&gt; </div>
<div class="line">    &lt;Value type=<span class="stringliteral">&quot;ntext&quot;</span>&gt;value&lt;/Value&gt; </div>
<div class="line">    &lt;Value2 type=<span class="stringliteral">&quot;text&quot;</span>&gt;NULL&lt;/Value2&gt; </div>
<div class="line">    &lt;Value3 type=<span class="stringliteral">&quot;varchar&quot;</span>&gt;NULL&lt;/Value3&gt; </div>
<div class="line">    &lt;SomeNumber type=<span class="stringliteral">&quot;integer&quot;</span>&gt;2&lt;/SomeNumber&gt; </div>
<div class="line">   &lt;/Row&gt;</div>
<div class="line">   &lt;Row&gt;</div>
<div class="line">    &lt;EntryID type=<span class="stringliteral">&quot;integer&quot;</span>&gt;2&lt;/EntryID&gt; </div>
<div class="line">    &lt;Key type=<span class="stringliteral">&quot;nvarchar&quot;</span>&gt;key1&lt;/Key&gt; </div>
<div class="line">    &lt;Value type=<span class="stringliteral">&quot;ntext&quot;</span>&gt;value1&lt;/Value&gt; </div>
<div class="line">    &lt;Value2 type=<span class="stringliteral">&quot;text&quot;</span>&gt;NULL&lt;/Value2&gt; </div>
<div class="line">    &lt;Value3 type=<span class="stringliteral">&quot;varchar&quot;</span>&gt;NULL&lt;/Value3&gt; </div>
<div class="line">    &lt;SomeNumber type=<span class="stringliteral">&quot;integer&quot;</span>&gt;2&lt;/SomeNumber&gt; </div>
<div class="line">   &lt;/Row&gt;</div>
<div class="line">  &lt;/RowSet&gt;</div>
<div class="line"> &lt;/DataSet&gt;</div>
<div class="line">&lt;/Data&gt;</div>
</div><!-- fragment --><div class="fragment"><div class="line">$ odbq.exe --datafile Data.xml --outputfile Results.xml</div>
</div><!-- fragment --><p>The resulting out xml contains any messages from the ODBC driver and the number of rows affected.</p>
<div class="fragment"><div class="line">&lt;Data&gt;</div>
<div class="line"> &lt;DataSet table=<span class="stringliteral">&quot;MyDatabase.dbo.SomeTable&quot;</span> rowsaffected=<span class="stringliteral">&quot;2&quot;</span>&gt;</div>
<div class="line">  &lt;Messages /&gt; </div>
<div class="line"> &lt;/DataSet&gt;</div>
<div class="line">&lt;/Data&gt;</div>
</div><!-- fragment --><h2><a class="anchor" id="odbq_exe_examples_multiple"></a>
Executing multiple statements with a connection string specified.</h2>
<p>Note that if you choose to mix &ndash;sql and &ndash;file options, SQL queries are executed first, followed by execution of file contents.</p>
<div class="fragment"><div class="line">$ odbq.exe --sql <span class="stringliteral">&quot;SELECT @@VERSION&quot;</span> --sql <span class="stringliteral">&quot;PRINT &#39;Hello World&#39;&quot;</span> --connectionstring <span class="stringliteral">&quot;Driver=SQL Server;Server=.;Trusted_Connection=yes&quot;</span></div>
<div class="line"></div>
<div class="line">ODBQ 1.0.2758.0 - Copyright (c) Application Security Inc.</div>
<div class="line"></div>
<div class="line">- Connecting with &quot;Driver=SQL Server;Server=.;Trusted_Connection=yes&quot;</div>
<div class="line">&gt; SELECT @@VERSION</div>
<div class="line">&lt; 1x1</div>
<div class="line">Column1</div>
<div class="line">-------</div>
<div class="line">Microsoft SQL Server 2005 - 9.00.3068.00 (Intel X86)</div>
<div class="line">        Feb 26 2008 18:15:01</div>
<div class="line">        Copyright (c) 1988-2005 Microsoft Corporation</div>
<div class="line">        Standard Edition on Windows NT 5.1 (Build 2600: Service Pack 3)</div>
<div class="line">&gt; PRINT &#39;Hello World&#39;</div>
<div class="line">&lt; Hello World</div>
</div><!-- fragment --> </div></div><!-- contents -->
  <br><hr noshade>
  <table width="100%">
   <tr>
    <td valign="top" align="left">
     <font size="1">&copy; Application Security Inc. - All Rights Reserved</font>
    </td>
    <td valign="top" align="right">
     <a href="http://msiext.codeplex.com" target="_blank">http://msiext.codeplex.com</a>
    </td>
   </tr>
  </table>
 </body>
 <head>
  <link href="tabs.css" rel="stylesheet" type="text/css">
 </head>
</html>
