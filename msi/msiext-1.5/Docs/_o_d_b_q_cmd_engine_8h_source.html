<html>
 <head>
  <link rel="stylesheet" href="maven-theme.css"> 
  <title>AppSecInc. MSI Extensions</title>
 </head>
 <body>
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_b90d73d79b67ccd72c2aaf78972ad885.html">Tools</a></li><li class="navelem"><a class="el" href="dir_f2568063b1678468f2f42389316e2aa5.html">ODBQ</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ODBQCmdEngine.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_o_d_b_q_cmd_engine_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#pragma once</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00003"></a><span class="lineno"><a class="line" href="class_o_d_b_q_cmd_engine.html">    3</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_o_d_b_q_cmd_engine.html">ODBQCmdEngine</a></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;{</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;    <a class="code" href="class_app_sec_inc_1_1_xml_1_1_xml_document.html">AppSecInc::Xml::XmlDocument</a> _xmlresults;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    MSXML2::IXMLDOMNodePtr _xmlresults_rootnode;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    std::wstring output;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00014"></a><span class="lineno"><a class="line" href="class_o_d_b_q_cmd_engine.html#a071f824d2e49e35fc13c59b8cb130cd4">   14</a></span>&#160;    TCLAP::CmdLine <a class="code" href="class_o_d_b_q_cmd_engine.html#a071f824d2e49e35fc13c59b8cb130cd4">_cmd</a>;</div>
<div class="line"><a name="l00016"></a><span class="lineno"><a class="line" href="class_o_d_b_q_cmd_engine.html#a0c90ed8b712cbd5f79d08a5b834cfa68">   16</a></span>&#160;        TCLAP::SwitchArg <a class="code" href="class_o_d_b_q_cmd_engine.html#a0c90ed8b712cbd5f79d08a5b834cfa68">_nologo</a>;</div>
<div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="class_o_d_b_q_cmd_engine.html#a50aeff706ee5d484bdbfe92e50c8e4a6">   18</a></span>&#160;        TCLAP::SwitchArg <a class="code" href="class_o_d_b_q_cmd_engine.html#a50aeff706ee5d484bdbfe92e50c8e4a6">_nosql</a>;</div>
<div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="class_o_d_b_q_cmd_engine.html#a93729c7e4b76227805bdf666ffe9984a">   20</a></span>&#160;        TCLAP::SwitchArg <a class="code" href="class_o_d_b_q_cmd_engine.html#a93729c7e4b76227805bdf666ffe9984a">_noresults</a>;</div>
<div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="class_o_d_b_q_cmd_engine.html#a75a428eeb3019ead20d50f4a918ddc21">   22</a></span>&#160;    TCLAP::ValueArg&lt;std::wstring&gt; <a class="code" href="class_o_d_b_q_cmd_engine.html#a75a428eeb3019ead20d50f4a918ddc21">_connectionstring</a>;</div>
<div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="class_o_d_b_q_cmd_engine.html#a3adc9d01be5355abdaafd0f2c033e296">   24</a></span>&#160;    TCLAP::ValueArg&lt;std::wstring&gt; <a class="code" href="class_o_d_b_q_cmd_engine.html#a3adc9d01be5355abdaafd0f2c033e296">_database</a>;</div>
<div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="class_o_d_b_q_cmd_engine.html#a16ca4c7071133a337c44b96a8074f6c8">   26</a></span>&#160;    TCLAP::MultiArg&lt;std::wstring&gt; <a class="code" href="class_o_d_b_q_cmd_engine.html#a16ca4c7071133a337c44b96a8074f6c8">_sql</a>;</div>
<div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="class_o_d_b_q_cmd_engine.html#aa47928a0bf454723fbb30251b5bfdae1">   28</a></span>&#160;    TCLAP::MultiArg&lt;std::wstring&gt; <a class="code" href="class_o_d_b_q_cmd_engine.html#aa47928a0bf454723fbb30251b5bfdae1">_file</a>;</div>
<div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="class_o_d_b_q_cmd_engine.html#a4f8c82a52942baf7d87a1d3522038efc">   30</a></span>&#160;    TCLAP::ValueArg&lt;std::wstring&gt; <a class="code" href="class_o_d_b_q_cmd_engine.html#a4f8c82a52942baf7d87a1d3522038efc">_type</a>;</div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="class_o_d_b_q_cmd_engine.html#a0ffd54d3392e49ae1b1d878cdd71a3cf">   32</a></span>&#160;    TCLAP::ValueArg&lt;std::wstring&gt; <a class="code" href="class_o_d_b_q_cmd_engine.html#a0ffd54d3392e49ae1b1d878cdd71a3cf">_delimiter</a>;</div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="class_o_d_b_q_cmd_engine.html#ac00d05f0635b8b809cd448c832cbc29a">   34</a></span>&#160;    TCLAP::ValueArg&lt;std::wstring&gt; <a class="code" href="class_o_d_b_q_cmd_engine.html#ac00d05f0635b8b809cd448c832cbc29a">_outputfile</a>;</div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="class_o_d_b_q_cmd_engine.html#a5a2144dde09bdde834071972d758a2af">   36</a></span>&#160;    TCLAP::MultiArg&lt;std::wstring&gt; <a class="code" href="class_o_d_b_q_cmd_engine.html#a5a2144dde09bdde834071972d758a2af">_datafile</a>;</div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="class_o_d_b_q_cmd_engine.html#a26dcabe80362ea65b09481547e722ec5">   38</a></span>&#160;    TCLAP::SwitchArg <a class="code" href="class_o_d_b_q_cmd_engine.html#a26dcabe80362ea65b09481547e722ec5">_flatten</a>;</div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="class_o_d_b_q_cmd_engine.html#aa07949bbe6c111949503d74812df3072">   40</a></span>&#160;    TCLAP::SwitchArg <a class="code" href="class_o_d_b_q_cmd_engine.html#aa07949bbe6c111949503d74812df3072">_rawoutput</a>;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="class_o_d_b_q_cmd_engine.html#a62e0b1904dca3bc38d4e36a64ffbccaf">ODBQCmdEngine</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">wchar_t</span> * argv[]);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_o_d_b_q_cmd_engine.html#ac1e7cb2dd90fe5e186094ac4615e1abf">Execute</a>();</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        std::wstring GetConnectionString();</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordtype">void</span> ExecuteSql(<span class="keyword">const</span> std::wstring&amp; query);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordtype">void</span> ExecuteFile(<span class="keyword">const</span> std::wstring&amp; file);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_o_d_b_q_cmd_engine.html#ac1e7cb2dd90fe5e186094ac4615e1abf">Execute</a>(<a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html">AppSecInc::Databases::ODBC::OdbcParser</a>&amp; parser);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordtype">void</span> InsertDataFile(<span class="keyword">const</span> std::wstring&amp; file);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;};</div>
<div class="ttc" id="class_o_d_b_q_cmd_engine_html_a50aeff706ee5d484bdbfe92e50c8e4a6"><div class="ttname"><a href="class_o_d_b_q_cmd_engine.html#a50aeff706ee5d484bdbfe92e50c8e4a6">ODBQCmdEngine::_nosql</a></div><div class="ttdeci">TCLAP::SwitchArg _nosql</div><div class="ttdoc">suppress SQL statement output to console </div><div class="ttdef"><b>Definition:</b> ODBQCmdEngine.h:18</div></div>
<div class="ttc" id="class_o_d_b_q_cmd_engine_html_a071f824d2e49e35fc13c59b8cb130cd4"><div class="ttname"><a href="class_o_d_b_q_cmd_engine.html#a071f824d2e49e35fc13c59b8cb130cd4">ODBQCmdEngine::_cmd</a></div><div class="ttdeci">TCLAP::CmdLine _cmd</div><div class="ttdoc">command line parameters </div><div class="ttdef"><b>Definition:</b> ODBQCmdEngine.h:14</div></div>
<div class="ttc" id="class_o_d_b_q_cmd_engine_html_aa47928a0bf454723fbb30251b5bfdae1"><div class="ttname"><a href="class_o_d_b_q_cmd_engine.html#aa47928a0bf454723fbb30251b5bfdae1">ODBQCmdEngine::_file</a></div><div class="ttdeci">TCLAP::MultiArg&lt; std::wstring &gt; _file</div><div class="ttdoc">sql file(s) to execute </div><div class="ttdef"><b>Definition:</b> ODBQCmdEngine.h:28</div></div>
<div class="ttc" id="class_o_d_b_q_cmd_engine_html_a93729c7e4b76227805bdf666ffe9984a"><div class="ttname"><a href="class_o_d_b_q_cmd_engine.html#a93729c7e4b76227805bdf666ffe9984a">ODBQCmdEngine::_noresults</a></div><div class="ttdeci">TCLAP::SwitchArg _noresults</div><div class="ttdoc">quiet execution, no results output </div><div class="ttdef"><b>Definition:</b> ODBQCmdEngine.h:20</div></div>
<div class="ttc" id="class_o_d_b_q_cmd_engine_html_a4f8c82a52942baf7d87a1d3522038efc"><div class="ttname"><a href="class_o_d_b_q_cmd_engine.html#a4f8c82a52942baf7d87a1d3522038efc">ODBQCmdEngine::_type</a></div><div class="ttdeci">TCLAP::ValueArg&lt; std::wstring &gt; _type</div><div class="ttdoc">sql type, default - SqlServer </div><div class="ttdef"><b>Definition:</b> ODBQCmdEngine.h:30</div></div>
<div class="ttc" id="class_o_d_b_q_cmd_engine_html_a3adc9d01be5355abdaafd0f2c033e296"><div class="ttname"><a href="class_o_d_b_q_cmd_engine.html#a3adc9d01be5355abdaafd0f2c033e296">ODBQCmdEngine::_database</a></div><div class="ttdeci">TCLAP::ValueArg&lt; std::wstring &gt; _database</div><div class="ttdoc">optional database name </div><div class="ttdef"><b>Definition:</b> ODBQCmdEngine.h:24</div></div>
<div class="ttc" id="class_app_sec_inc_1_1_xml_1_1_xml_document_html"><div class="ttname"><a href="class_app_sec_inc_1_1_xml_1_1_xml_document.html">AppSecInc::Xml::XmlDocument</a></div><div class="ttdoc">An MSXML document. </div><div class="ttdef"><b>Definition:</b> XmlDocument.h:8</div></div>
<div class="ttc" id="class_o_d_b_q_cmd_engine_html"><div class="ttname"><a href="class_o_d_b_q_cmd_engine.html">ODBQCmdEngine</a></div><div class="ttdef"><b>Definition:</b> ODBQCmdEngine.h:3</div></div>
<div class="ttc" id="class_o_d_b_q_cmd_engine_html_a16ca4c7071133a337c44b96a8074f6c8"><div class="ttname"><a href="class_o_d_b_q_cmd_engine.html#a16ca4c7071133a337c44b96a8074f6c8">ODBQCmdEngine::_sql</a></div><div class="ttdeci">TCLAP::MultiArg&lt; std::wstring &gt; _sql</div><div class="ttdoc">sql queries </div><div class="ttdef"><b>Definition:</b> ODBQCmdEngine.h:26</div></div>
<div class="ttc" id="class_o_d_b_q_cmd_engine_html_a62e0b1904dca3bc38d4e36a64ffbccaf"><div class="ttname"><a href="class_o_d_b_q_cmd_engine.html#a62e0b1904dca3bc38d4e36a64ffbccaf">ODBQCmdEngine::ODBQCmdEngine</a></div><div class="ttdeci">ODBQCmdEngine(int argc, wchar_t *argv[])</div><div class="ttdef"><b>Definition:</b> ODBQCmdEngine.cpp:4</div></div>
<div class="ttc" id="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser_html"><div class="ttname"><a href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html">AppSecInc::Databases::ODBC::OdbcParser</a></div><div class="ttdef"><b>Definition:</b> OdbcParser.h:38</div></div>
<div class="ttc" id="class_o_d_b_q_cmd_engine_html_a75a428eeb3019ead20d50f4a918ddc21"><div class="ttname"><a href="class_o_d_b_q_cmd_engine.html#a75a428eeb3019ead20d50f4a918ddc21">ODBQCmdEngine::_connectionstring</a></div><div class="ttdeci">TCLAP::ValueArg&lt; std::wstring &gt; _connectionstring</div><div class="ttdoc">connection string </div><div class="ttdef"><b>Definition:</b> ODBQCmdEngine.h:22</div></div>
<div class="ttc" id="class_o_d_b_q_cmd_engine_html_a26dcabe80362ea65b09481547e722ec5"><div class="ttname"><a href="class_o_d_b_q_cmd_engine.html#a26dcabe80362ea65b09481547e722ec5">ODBQCmdEngine::_flatten</a></div><div class="ttdeci">TCLAP::SwitchArg _flatten</div><div class="ttdoc">flatten-only flag, don&amp;#39;t execute sql </div><div class="ttdef"><b>Definition:</b> ODBQCmdEngine.h:38</div></div>
<div class="ttc" id="class_o_d_b_q_cmd_engine_html_aa07949bbe6c111949503d74812df3072"><div class="ttname"><a href="class_o_d_b_q_cmd_engine.html#aa07949bbe6c111949503d74812df3072">ODBQCmdEngine::_rawoutput</a></div><div class="ttdeci">TCLAP::SwitchArg _rawoutput</div><div class="ttdoc">raw output flag </div><div class="ttdef"><b>Definition:</b> ODBQCmdEngine.h:40</div></div>
<div class="ttc" id="class_o_d_b_q_cmd_engine_html_ac1e7cb2dd90fe5e186094ac4615e1abf"><div class="ttname"><a href="class_o_d_b_q_cmd_engine.html#ac1e7cb2dd90fe5e186094ac4615e1abf">ODBQCmdEngine::Execute</a></div><div class="ttdeci">void Execute()</div><div class="ttdoc">execute per command line args </div><div class="ttdef"><b>Definition:</b> ODBQCmdEngine.cpp:39</div></div>
<div class="ttc" id="class_o_d_b_q_cmd_engine_html_a0ffd54d3392e49ae1b1d878cdd71a3cf"><div class="ttname"><a href="class_o_d_b_q_cmd_engine.html#a0ffd54d3392e49ae1b1d878cdd71a3cf">ODBQCmdEngine::_delimiter</a></div><div class="ttdeci">TCLAP::ValueArg&lt; std::wstring &gt; _delimiter</div><div class="ttdoc">optional delimiter </div><div class="ttdef"><b>Definition:</b> ODBQCmdEngine.h:32</div></div>
<div class="ttc" id="class_o_d_b_q_cmd_engine_html_a0c90ed8b712cbd5f79d08a5b834cfa68"><div class="ttname"><a href="class_o_d_b_q_cmd_engine.html#a0c90ed8b712cbd5f79d08a5b834cfa68">ODBQCmdEngine::_nologo</a></div><div class="ttdeci">TCLAP::SwitchArg _nologo</div><div class="ttdoc">remove banner </div><div class="ttdef"><b>Definition:</b> ODBQCmdEngine.h:16</div></div>
<div class="ttc" id="class_o_d_b_q_cmd_engine_html_ac00d05f0635b8b809cd448c832cbc29a"><div class="ttname"><a href="class_o_d_b_q_cmd_engine.html#ac00d05f0635b8b809cd448c832cbc29a">ODBQCmdEngine::_outputfile</a></div><div class="ttdeci">TCLAP::ValueArg&lt; std::wstring &gt; _outputfile</div><div class="ttdoc">optional output filename </div><div class="ttdef"><b>Definition:</b> ODBQCmdEngine.h:34</div></div>
<div class="ttc" id="class_o_d_b_q_cmd_engine_html_a5a2144dde09bdde834071972d758a2af"><div class="ttname"><a href="class_o_d_b_q_cmd_engine.html#a5a2144dde09bdde834071972d758a2af">ODBQCmdEngine::_datafile</a></div><div class="ttdeci">TCLAP::MultiArg&lt; std::wstring &gt; _datafile</div><div class="ttdoc">xml data files to insert </div><div class="ttdef"><b>Definition:</b> ODBQCmdEngine.h:36</div></div>
</div><!-- fragment --></div><!-- contents -->
  <br><hr noshade>
  <table width="100%">
   <tr>
    <td valign="top" align="left">
     <font size="1">&copy; Application Security Inc. - All Rights Reserved</font>
    </td>
    <td valign="top" align="right">
     <a href="http://msiext.codeplex.com" target="_blank">http://msiext.codeplex.com</a>
    </td>
   </tr>
  </table>
 </body>
 <head>
  <link href="tabs.css" rel="stylesheet" type="text/css">
 </head>
</html>
