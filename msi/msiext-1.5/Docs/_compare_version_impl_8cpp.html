<html>
 <head>
  <link rel="stylesheet" href="maven-theme.css"> 
  <title>AppSecInc. MSI Extensions</title>
 </head>
 <body>
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_99a29c3169c5469df19432121ecc6f8d.html">CustomActions</a></li><li class="navelem"><a class="el" href="dir_c872b103f725756531e4398193585f23.html">SystemTools</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">CompareVersionImpl.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="_custom_actions_2_system_tools_2_std_afx_8h_source.html">StdAfx.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="_compare_version_impl_8h_source.html">CompareVersionImpl.h</a>&quot;</code><br/>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a67ba74418295711458a5bb496cdbe5ec"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_ca_decl_specs_8h.html#aff4b526ced58189f5c2252e52bdd57c6">CA_API</a> UINT __stdcall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_compare_version_impl_8cpp.html#a67ba74418295711458a5bb496cdbe5ec">CompareVersions</a> (MSIHANDLE hInstall)</td></tr>
<tr class="memdesc:a67ba74418295711458a5bb496cdbe5ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compares dotted version strings.  <a href="#a67ba74418295711458a5bb496cdbe5ec">More...</a><br/></td></tr>
<tr class="separator:a67ba74418295711458a5bb496cdbe5ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4abf1c3373921cf0eac8c22cba402e11"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_ca_decl_specs_8h.html#aff4b526ced58189f5c2252e52bdd57c6">CA_API</a> UINT __stdcall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_compare_version_impl_8cpp.html#a4abf1c3373921cf0eac8c22cba402e11">CompareVersion</a> (MSIHANDLE hInstall)</td></tr>
<tr class="memdesc:a4abf1c3373921cf0eac8c22cba402e11"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compares dotted version strings.  <a href="#a4abf1c3373921cf0eac8c22cba402e11">More...</a><br/></td></tr>
<tr class="separator:a4abf1c3373921cf0eac8c22cba402e11"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a4abf1c3373921cf0eac8c22cba402e11"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_ca_decl_specs_8h.html#aff4b526ced58189f5c2252e52bdd57c6">CA_API</a> UINT __stdcall CompareVersion </td>
          <td>(</td>
          <td class="paramtype">MSIHANDLE&#160;</td>
          <td class="paramname"><em>hInstall</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compares dotted version strings. </p>
<p>Compares the version string specfied by VERSION_INSTALLED to the version specified by VERSION_MINIMUM and optionally, VERSION_MAXIMUM. If VERSION_INSTALLED lies between these two versions, then the property specified by VERSION_PROPERTY is set.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VERSION_INSTALLED</td><td>version to compare </td></tr>
    <tr><td class="paramname">VERSION_MINIMUM</td><td>mimumum allowed version </td></tr>
    <tr><td class="paramname">VERSION_MAXIMUM</td><td>optional paramater specifying the maximum version allowed </td></tr>
    <tr><td class="paramname">VERSION_PROPERTY</td><td>property to set if the version check passes </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a67ba74418295711458a5bb496cdbe5ec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_ca_decl_specs_8h.html#aff4b526ced58189f5c2252e52bdd57c6">CA_API</a> UINT __stdcall CompareVersions </td>
          <td>(</td>
          <td class="paramtype">MSIHANDLE&#160;</td>
          <td class="paramname"><em>hInstall</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compares dotted version strings. </p>
<p>Compares the version string specfied by InstalledVersion to the version specified by MinimumVersion and optionally, MaximumVersion. If InstalledVersion lies between these two versions, then the property specified by the Property is set.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">InstalledVersion</td><td>version to compare </td></tr>
    <tr><td class="paramname">MinimumVersion</td><td>mimumum allowed version </td></tr>
    <tr><td class="paramname">MaximumVersion</td><td>optional paramater specifying the maximum version allowed </td></tr>
    <tr><td class="paramname">Property</td><td>property to set if the version check passes</td></tr>
  </table>
  </dd>
</dl>
<p>This is a table-driven custom action. It requires the following artifacts:</p>
<ol>
<li>
A custom table called CompareVersions. <div class="fragment"><div class="line">&lt;CustomTable Id=<span class="stringliteral">&quot;CompareVersions&quot;</span>&gt;</div>
<div class="line"> &lt;Column Id=<span class="stringliteral">&quot;Id&quot;</span> PrimaryKey=<span class="stringliteral">&quot;yes&quot;</span> Type=<span class="stringliteral">&quot;string&quot;</span> /&gt;</div>
<div class="line"> &lt;Column Id=<span class="stringliteral">&quot;InstalledVersion&quot;</span> Type=<span class="stringliteral">&quot;string&quot;</span> /&gt;</div>
<div class="line"> &lt;Column Id=<span class="stringliteral">&quot;MinimumVersion&quot;</span> Type=<span class="stringliteral">&quot;string&quot;</span> /&gt;</div>
<div class="line"> &lt;Column Id=<span class="stringliteral">&quot;MaximumVersion&quot;</span> Type=<span class="stringliteral">&quot;string&quot;</span> /&gt;</div>
<div class="line"> &lt;Column Id=<span class="stringliteral">&quot;Property&quot;</span> Type=<span class="stringliteral">&quot;string&quot;</span> /&gt;</div>
<div class="line">&lt;/CustomTable&gt;</div>
</div><!-- fragment --> </li>
<li>
An immediate CompareVersions custom action. <div class="fragment"><div class="line">&lt;CustomAction Id=<span class="stringliteral">&quot;CompareVersions&quot;</span> BinaryKey=<span class="stringliteral">&quot;SystemTools&quot;</span> DllEntry=<span class="stringliteral">&quot;CompareVersions&quot;</span> Execute=<span class="stringliteral">&quot;immediate&quot;</span> Return=<span class="stringliteral">&quot;check&quot;</span> /&gt;</div>
</div><!-- fragment --> </li>
<li>
An execution sequence that schedules the above custom actions before LaunchConditions. <div class="fragment"><div class="line">&lt;InstallExecuteSequence&gt;</div>
<div class="line"> &lt;Custom Action=<span class="stringliteral">&quot;CompareVersions&quot;</span> Before=<span class="stringliteral">&quot;LaunchConditions&quot;</span> Overridable=<span class="stringliteral">&quot;yes&quot;</span> /&gt;</div>
<div class="line">&lt;/InstallExecuteSequence&gt;</div>
<div class="line">&lt;InstallUISequence&gt;</div>
<div class="line"> &lt;Custom Action=<span class="stringliteral">&quot;CompareVersions&quot;</span> Before=<span class="stringliteral">&quot;LaunchConditions&quot;</span> Overridable=<span class="stringliteral">&quot;yes&quot;</span> /&gt;</div>
<div class="line">&lt;/InstallUISequence&gt;</div>
</div><!-- fragment --> </li>
</ol>

</div>
</div>
</div><!-- contents -->
  <br><hr noshade>
  <table width="100%">
   <tr>
    <td valign="top" align="left">
     <font size="1">&copy; Application Security Inc. - All Rights Reserved</font>
    </td>
    <td valign="top" align="right">
     <a href="http://msiext.codeplex.com" target="_blank">http://msiext.codeplex.com</a>
    </td>
   </tr>
  </table>
 </body>
 <head>
  <link href="tabs.css" rel="stylesheet" type="text/css">
 </head>
</html>
