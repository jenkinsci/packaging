<html>
 <head>
  <link rel="stylesheet" href="maven-theme.css"> 
  <title>AppSecInc. MSI Extensions</title>
 </head>
 <body>
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_ba210d1fa67db7bee1bb22e0a3c11d9f.html">Common</a></li><li class="navelem"><a class="el" href="dir_64ea9caef674d976e40f2281e2f7ca91.html">ODBC</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">OdbcParser.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_odbc_parser_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#pragma once</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_path_resolver_8h.html">PathResolver.h</a>&quot;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="keyword">namespace </span>AppSecInc</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;{</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;        <span class="keyword">namespace </span>Databases</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;        {</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;                <span class="keyword">namespace </span>ODBC</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;                {</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;                        <span class="keyword">class </span>OdbcParserImpl;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;                        </div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html">   38</a></span>&#160;                        <span class="keyword">class </span><a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html">OdbcParser</a></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                        {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                          <span class="keyword">public</span>:</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                                <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html#a1409a8fb0dbe06a26242b208c490eaed">OdbcParser</a>();</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                                <span class="keyword">virtual</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html#a2bbef0bcff8a8806bb5f0e95a50ba224">~OdbcParser</a>();</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                                <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html#a8039c18c515b88c64c5d3ea6e181a562">setSqlFlavour</a>(<span class="keyword">const</span> std::wstring&amp; sqlFlavour);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                                <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html#ae7610dc5263c958a86f3fa09bddc31c8">setDelimiters</a>(<span class="keyword">const</span> std::vector&lt;const std::wstring&gt;&amp; delimiters);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                                <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html#a3d5798b6f2bd4c1c6c0530030583f384">setSqlTypeOrDelimiter</a>(<span class="keyword">const</span> std::wstring&amp; type, <span class="keyword">const</span> std::wstring&amp; delimiter);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                                <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html#af96d7fc1f8a00083b255d23d36d55779">setPathResolver</a>(<a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_path_resolver.html">PathResolver</a>* pathResolver);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                                <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html#a9fac3055328fac0fe58250742a3de192">setSourcePath</a>(<span class="keyword">const</span> std::wstring&amp; sourceName);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                                <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html#ac8d7d9f0e9a449162e00b3a0ea251229">setInput</a>(<span class="keyword">const</span> std::wstring&amp; input);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                                <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_path_resolver.html">PathResolver</a>* <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html#afa592aa4baebb16050b5e39f26f9e91f">getPathResolver</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                                <span class="keywordtype">bool</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html#a754d5d270916665f97a74a5cef10213a">hasMore</a>();</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                                std::wstring <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html#a0f117775ceb04ef4792245d8a03bc3e5">getNextBatch</a>();</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                                <span class="keywordtype">bool</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html#aa11070d582f3549d7ff8806720699017">exitOnErrorFlag</a>();</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                                std::wstring <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html#ade947f62935e094ac167eeb828f24974">processInsertsOnly</a>();</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                          <span class="keyword">private</span>:</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                                <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html#a1409a8fb0dbe06a26242b208c490eaed">OdbcParser</a>(<span class="keyword">const</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html">OdbcParser</a>&amp; other);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                                <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html">OdbcParser</a>&amp; operator=(<span class="keyword">const</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html">OdbcParser</a>&amp; other);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                                <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser_impl.html">OdbcParserImpl</a>* pimpl;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                        };</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;}</div>
<div class="ttc" id="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser_html_a0f117775ceb04ef4792245d8a03bc3e5"><div class="ttname"><a href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html#a0f117775ceb04ef4792245d8a03bc3e5">AppSecInc::Databases::ODBC::OdbcParser::getNextBatch</a></div><div class="ttdeci">std::wstring getNextBatch()</div><div class="ttdoc">get next batch to execute </div><div class="ttdef"><b>Definition:</b> OdbcParser.cpp:69</div></div>
<div class="ttc" id="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser_html_afa592aa4baebb16050b5e39f26f9e91f"><div class="ttname"><a href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html#afa592aa4baebb16050b5e39f26f9e91f">AppSecInc::Databases::ODBC::OdbcParser::getPathResolver</a></div><div class="ttdeci">PathResolver * getPathResolver() const </div><div class="ttdoc">get path resolver used </div><div class="ttdef"><b>Definition:</b> OdbcParser.cpp:47</div></div>
<div class="ttc" id="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser_html_a2bbef0bcff8a8806bb5f0e95a50ba224"><div class="ttname"><a href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html#a2bbef0bcff8a8806bb5f0e95a50ba224">AppSecInc::Databases::ODBC::OdbcParser::~OdbcParser</a></div><div class="ttdeci">virtual ~OdbcParser()</div><div class="ttdef"><b>Definition:</b> OdbcParser.cpp:11</div></div>
<div class="ttc" id="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser_html_a8039c18c515b88c64c5d3ea6e181a562"><div class="ttname"><a href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html#a8039c18c515b88c64c5d3ea6e181a562">AppSecInc::Databases::ODBC::OdbcParser::setSqlFlavour</a></div><div class="ttdeci">void setSqlFlavour(const std::wstring &amp;sqlFlavour)</div><div class="ttdoc">select sql flavor (type of command-line tool) </div><div class="ttdef"><b>Definition:</b> OdbcParser.cpp:16</div></div>
<div class="ttc" id="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser_html_ac8d7d9f0e9a449162e00b3a0ea251229"><div class="ttname"><a href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html#ac8d7d9f0e9a449162e00b3a0ea251229">AppSecInc::Databases::ODBC::OdbcParser::setInput</a></div><div class="ttdeci">void setInput(const std::wstring &amp;input)</div><div class="ttdoc">set input string to process </div><div class="ttdef"><b>Definition:</b> OdbcParser.cpp:58</div></div>
<div class="ttc" id="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser_html_a9fac3055328fac0fe58250742a3de192"><div class="ttname"><a href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html#a9fac3055328fac0fe58250742a3de192">AppSecInc::Databases::ODBC::OdbcParser::setSourcePath</a></div><div class="ttdeci">void setSourcePath(const std::wstring &amp;sourceName)</div><div class="ttdoc">set input source path (e.g. file name or MSI binary ID) </div><div class="ttdef"><b>Definition:</b> OdbcParser.cpp:52</div></div>
<div class="ttc" id="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser_impl_html"><div class="ttname"><a href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser_impl.html">AppSecInc::Databases::ODBC::OdbcParserImpl</a></div><div class="ttdef"><b>Definition:</b> OdbcParserImpl.h:13</div></div>
<div class="ttc" id="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser_html"><div class="ttname"><a href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html">AppSecInc::Databases::ODBC::OdbcParser</a></div><div class="ttdef"><b>Definition:</b> OdbcParser.h:38</div></div>
<div class="ttc" id="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser_html_aa11070d582f3549d7ff8806720699017"><div class="ttname"><a href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html#aa11070d582f3549d7ff8806720699017">AppSecInc::Databases::ODBC::OdbcParser::exitOnErrorFlag</a></div><div class="ttdeci">bool exitOnErrorFlag()</div><div class="ttdoc">returns current state of error processing in the script </div><div class="ttdef"><b>Definition:</b> OdbcParser.cpp:74</div></div>
<div class="ttc" id="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser_html_a1409a8fb0dbe06a26242b208c490eaed"><div class="ttname"><a href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html#a1409a8fb0dbe06a26242b208c490eaed">AppSecInc::Databases::ODBC::OdbcParser::OdbcParser</a></div><div class="ttdeci">OdbcParser()</div><div class="ttdef"><b>Definition:</b> OdbcParser.cpp:6</div></div>
<div class="ttc" id="_path_resolver_8h_html"><div class="ttname"><a href="_path_resolver_8h.html">PathResolver.h</a></div></div>
<div class="ttc" id="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_path_resolver_html"><div class="ttname"><a href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_path_resolver.html">AppSecInc::Databases::ODBC::PathResolver</a></div><div class="ttdef"><b>Definition:</b> PathResolver.h:14</div></div>
<div class="ttc" id="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser_html_a754d5d270916665f97a74a5cef10213a"><div class="ttname"><a href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html#a754d5d270916665f97a74a5cef10213a">AppSecInc::Databases::ODBC::OdbcParser::hasMore</a></div><div class="ttdeci">bool hasMore()</div><div class="ttdoc">check if there are more batches in the input </div><div class="ttdef"><b>Definition:</b> OdbcParser.cpp:64</div></div>
<div class="ttc" id="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser_html_a3d5798b6f2bd4c1c6c0530030583f384"><div class="ttname"><a href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html#a3d5798b6f2bd4c1c6c0530030583f384">AppSecInc::Databases::ODBC::OdbcParser::setSqlTypeOrDelimiter</a></div><div class="ttdeci">void setSqlTypeOrDelimiter(const std::wstring &amp;type, const std::wstring &amp;delimiter)</div><div class="ttdoc">convenience method that sets either sql flavour or delimiter - whichever not empty. </div><div class="ttdef"><b>Definition:</b> OdbcParser.cpp:26</div></div>
<div class="ttc" id="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser_html_ade947f62935e094ac167eeb828f24974"><div class="ttname"><a href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html#ade947f62935e094ac167eeb828f24974">AppSecInc::Databases::ODBC::OdbcParser::processInsertsOnly</a></div><div class="ttdeci">std::wstring processInsertsOnly()</div><div class="ttdoc">return input with all files inserted (flatten input) </div><div class="ttdef"><b>Definition:</b> OdbcParser.cpp:79</div></div>
<div class="ttc" id="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser_html_ae7610dc5263c958a86f3fa09bddc31c8"><div class="ttname"><a href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html#ae7610dc5263c958a86f3fa09bddc31c8">AppSecInc::Databases::ODBC::OdbcParser::setDelimiters</a></div><div class="ttdeci">void setDelimiters(const std::vector&lt; const std::wstring &gt; &amp;delimiters)</div><div class="ttdoc">set arbitrary delimiters (insert commands not supported) </div><div class="ttdef"><b>Definition:</b> OdbcParser.cpp:21</div></div>
<div class="ttc" id="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser_html_af96d7fc1f8a00083b255d23d36d55779"><div class="ttname"><a href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_odbc_parser.html#af96d7fc1f8a00083b255d23d36d55779">AppSecInc::Databases::ODBC::OdbcParser::setPathResolver</a></div><div class="ttdeci">void setPathResolver(PathResolver *pathResolver)</div><div class="ttdoc">set path resolver (default - file system path resolver) </div><div class="ttdef"><b>Definition:</b> OdbcParser.cpp:42</div></div>
</div><!-- fragment --></div><!-- contents -->
  <br><hr noshade>
  <table width="100%">
   <tr>
    <td valign="top" align="left">
     <font size="1">&copy; Application Security Inc. - All Rights Reserved</font>
    </td>
    <td valign="top" align="right">
     <a href="http://msiext.codeplex.com" target="_blank">http://msiext.codeplex.com</a>
    </td>
   </tr>
  </table>
 </body>
 <head>
  <link href="tabs.css" rel="stylesheet" type="text/css">
 </head>
</html>
